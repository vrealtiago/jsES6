{"version":3,"sources":["../../app-es6/controller/NegociacaoController.js"],"names":["NegociacaoController","_ordemAtual","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_service","NegociacaoService","_listaNegociacoes","Bind","ListaNegociacoes","NegociacoesView","_mensagem","Mensagem","MensagemView","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texo","erro","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","texto","mensagem","_cleanForm","importa","error","apaga","esvazia","Negociacao","DateHelper","textoParaData","value","parseInt","parseFloat","focus","coluna","inverteOrdem","ordena","a","b"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["class NegociacaoController{\r\n\r\n    constructor() {\r\n\t    this._ordemAtual = '';\r\n\t    let $ = document.querySelector.bind(document);\r\n\t    this._inputData = $('#data');\r\n\t    this._inputQuantidade = $('#quantidade');\r\n\t    this._inputValor = $('#valor');\r\n\t    this._service = new NegociacaoService();\r\n\t    this._listaNegociacoes = new Bind(\r\n\t\t    new ListaNegociacoes(),\r\n\t\t    new NegociacoesView($('#negociacoesView')),\r\n\t\t    'adiciona', 'esvazia', 'ordena', 'inverteOrdem');\r\n\r\n\t    this._mensagem = new Bind(\r\n\t\t    new Mensagem(), new MensagemView($('#mensagemView')),\r\n\t\t    'texto');\r\n\r\n\t\tthis._init();\r\n\r\n    }\r\n\r\n    _init(){\r\n\t    this._service\r\n\t\t    .lista()\r\n\t\t    .then(negociacoes =>\r\n\t\t\t    negociacoes.forEach(negociacao =>\r\n\t\t\t\t    this._listaNegociacoes.adiciona(negociacao)))\r\n\t\t    .catch(erro => this._mensagem.texo = erro);\r\n\r\n\t    setInterval(() => {\r\n\t    \tthis.importaNegociacoes();\r\n\t    }, 3000);\r\n    }\r\n\r\n    adiciona(event){\r\n\t    event.preventDefault();\r\n\t    let negociacao = this._criaNegociacao();\r\n\r\n\t    this._service\r\n\t\t    .cadastra(negociacao)\r\n\t\t    .then(mensagem => {\r\n\t\t\t    this._listaNegociacoes.adiciona(negociacao);\r\n\t\t\t    this._mensagem.texto = mensagem;\r\n\t\t\t    this._cleanForm();\r\n\t\t    }).catch(erro => this._mensagem.texto = erro);\r\n    }\r\n\r\n\timportaNegociacoes(){\r\n\t\tthis._service\r\n\t\t\t.importa(this._listaNegociacoes.negociacoes)\r\n\t        .then(negociacoes => {\r\n        \t    negociacoes.forEach(negociacao => this._listaNegociacoes.adiciona(negociacao));\r\n        \t    this._mensagem.texto = 'Negociacoes do periodo importadas com sucesso';\r\n            })\r\n            .catch(error => this._mensagem.texto = error);\r\n    }\r\n\r\n    apagar(){\r\n\t    this._service\r\n\t\t    .apaga()\r\n\t\t    .then(mensagem => {\r\n\t\t\t    this._listaNegociacoes.esvazia();\r\n\t\t\t    this._mensagem.texto = mensagem;\r\n\t\t    }).catch(erro => this._mensagem.texto = erro);\r\n    }\r\n\r\n    _criaNegociacao(){\r\n        return new Negociacao(\r\n            DateHelper.textoParaData(this._inputData.value),\r\n            parseInt(this._inputQuantidade.value),\r\n            parseFloat(this._inputValor.value));\r\n    }\r\n\r\n    _cleanForm(){\r\n        this._inputData.value = '';\r\n        this._inputQuantidade.value = 1;\r\n        this._inputValor.value = 0.0;\r\n        this._inputData.focus();\r\n    }\r\n\r\n    ordena(coluna){\r\n        if(this._ordemAtual == coluna){\r\n            this._listaNegociacoes.inverteOrdem();\r\n        }else{\r\n\t        this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\r\n        }\r\n        this._ordemAtual = coluna;\r\n    }\r\n\r\n}"]}