{"version":3,"sources":["../../app-es6/controller/NegociacaoController.js"],"names":["currentInstance","negociacaoController","ListaNegociacoes","Mensagem","NegociacoesView","MensagemView","NegociacaoService","DateHelper","Bind","Negociacao","NegociacaoController","_ordemAtual","$","document","querySelector","bind","_inputData","_inputQuantidade","_inputValor","_service","_listaNegociacoes","_mensagem","_init","lista","then","negociacoes","forEach","adiciona","negociacao","catch","texo","erro","setInterval","importaNegociacoes","event","preventDefault","_criaNegociacao","cadastra","texto","mensagem","_cleanForm","importa","error","apaga","esvazia","textoParaData","value","parseInt","parseFloat","focus","coluna","inverteOrdem","ordena","a","b"],"mappings":"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","file":"NegociacaoController.js","sourcesContent":["import{ListaNegociacoes} from \"../models/ListaNegociacoes\";\r\nimport{Mensagem} from \"../models/Mensagem\";\r\nimport{NegociacoesView} from \"../views/NegociacoesView\";\r\nimport{MensagemView} from \"../views/MensagemView\";\r\nimport{NegociacaoService} from \"../services/NegociacaoService\";\r\nimport{DateHelper} from \"../helpers/DateHelper\";\r\nimport{Bind} from \"../helpers/Bind\";\r\nimport{Negociacao} from \"../models/Negociacao\";\r\n\r\nclass NegociacaoController{\r\n\r\n    constructor() {\r\n\t    this._ordemAtual = '';\r\n\t    let $ = document.querySelector.bind(document);\r\n\t    this._inputData = $('#data');\r\n\t    this._inputQuantidade = $('#quantidade');\r\n\t    this._inputValor = $('#valor');\r\n\t    this._service = new NegociacaoService();\r\n\t    this._listaNegociacoes = new Bind(\r\n\t\t    new ListaNegociacoes(),\r\n\t\t    new NegociacoesView($('#negociacoesView')),\r\n\t\t    'adiciona', 'esvazia', 'ordena', 'inverteOrdem');\r\n\r\n\t    this._mensagem = new Bind(\r\n\t\t    new Mensagem(), new MensagemView($('#mensagemView')),\r\n\t\t    'texto');\r\n\r\n\t\tthis._init();\r\n\r\n    }\r\n\r\n    _init(){\r\n\t    this._service\r\n\t\t    .lista()\r\n\t\t    .then(negociacoes =>\r\n\t\t\t    negociacoes.forEach(negociacao =>\r\n\t\t\t\t    this._listaNegociacoes.adiciona(negociacao)))\r\n\t\t    .catch(erro => this._mensagem.texo = erro);\r\n\r\n\t    setInterval(() => {\r\n\t    \tthis.importaNegociacoes();\r\n\t    }, 3000);\r\n    }\r\n\r\n    adiciona(event){\r\n\t    event.preventDefault();\r\n\t    let negociacao = this._criaNegociacao();\r\n\r\n\t    this._service\r\n\t\t    .cadastra(negociacao)\r\n\t\t    .then(mensagem => {\r\n\t\t\t    this._listaNegociacoes.adiciona(negociacao);\r\n\t\t\t    this._mensagem.texto = mensagem;\r\n\t\t\t    this._cleanForm();\r\n\t\t    }).catch(erro => this._mensagem.texto = erro);\r\n    }\r\n\r\n\timportaNegociacoes(){\r\n\t\tthis._service\r\n\t\t\t.importa(this._listaNegociacoes.negociacoes)\r\n\t        .then(negociacoes => {\r\n        \t    negociacoes.forEach(negociacao => this._listaNegociacoes.adiciona(negociacao));\r\n        \t    this._mensagem.texto = 'Negociacoes do periodo importadas com sucesso';\r\n            })\r\n            .catch(error => this._mensagem.texto = error);\r\n    }\r\n\r\n    apagar(){\r\n\t    this._service\r\n\t\t    .apaga()\r\n\t\t    .then(mensagem => {\r\n\t\t\t    this._listaNegociacoes.esvazia();\r\n\t\t\t    this._mensagem.texto = mensagem;\r\n\t\t    }).catch(erro => this._mensagem.texto = erro);\r\n    }\r\n\r\n    _criaNegociacao(){\r\n        return new Negociacao(\r\n            DateHelper.textoParaData(this._inputData.value),\r\n            parseInt(this._inputQuantidade.value),\r\n            parseFloat(this._inputValor.value));\r\n    }\r\n\r\n    _cleanForm(){\r\n        this._inputData.value = '';\r\n        this._inputQuantidade.value = 1;\r\n        this._inputValor.value = 0.0;\r\n        this._inputData.focus();\r\n    }\r\n\r\n    ordena(coluna){\r\n        if(this._ordemAtual == coluna){\r\n            this._listaNegociacoes.inverteOrdem();\r\n        }else{\r\n\t        this._listaNegociacoes.ordena((a, b) => a[coluna] - b[coluna]);\r\n        }\r\n        this._ordemAtual = coluna;\r\n    }\r\n}\r\n\r\nlet negociacaoController = new NegociacaoController();\r\nexport function currentInstance(){\r\n\treturn negociacaoController;\r\n}"]}