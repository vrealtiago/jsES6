{"version":3,"sources":["../../app-es6/services/NegociacaoService.js"],"names":["HttpService","ConnectionFactory","NegociacaoDao","Negociacao","NegociacaoService","_http","get","then","negociacoes","map","Date","objeto","data","quantidade","valor","catch","console","log","erro","Error","Promise","all","obterNegociacoesDaSemana","obterNegociacoesDaSemanaAnterior","obterNegociacoesDaSemanaRetrasada","periodos","reduce","dados","periodo","concat","negociacao","getConnection","connection","dao","adiciona","listaTodos","apagaTodos","listaAtual","obterNegociacoes","filter","some","isEquals","negociacaoExistente"],"mappings":"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","file":"NegociacaoService.js","sourcesContent":["import {HttpService} from \"./HttpService\";\r\nimport {ConnectionFactory} from \"./ConnectionFactory\";\r\nimport{NegociacaoDao} from \"../dao/NegociacaoDao\";\r\nimport {Negociacao} from \"../models/Negociacao\";\r\n\r\nexport class NegociacaoService{\r\n\tconstructor(){\r\n\t\tthis._http = new HttpService();\r\n\t}\r\n\r\n\tobterNegociacoesDaSemana(){\r\n\r\n\t\treturn this._http.get('negociacoes/semana')\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\treturn negociacoes.map(objeto => new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor));\r\n\t\t\t}).catch(erro => {\r\n\t\t\t\tconsole.log(erro);\r\n\t\t\t\tthrow new Error('Nao foi possivel obter as negociacoes da semana');\r\n\t\t\t});\r\n\t}\r\n\r\n\tobterNegociacoesDaSemanaAnterior(){\r\n\t\treturn this._http.get('negociacoes/anterior')\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\treturn negociacoes.map(objeto => new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor));\r\n\t\t\t}).catch(erro => {\r\n\t\t\t\tconsole.log(erro);\r\n\t\t\t\tthrow new Error('Nao foi possivel obter as negociacoes da semana Anterior');\r\n\t\t});\r\n\t}\r\n\r\n\tobterNegociacoesDaSemanaRetrasada(){\r\n\t\treturn this._http.get('negociacoes/retrasada')\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\treturn negociacoes.map(objeto => new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor));\r\n\t\t\t}).catch(erro => {\r\n\t\t\t\tconsole.log(erro);\r\n\t\t\t\tthrow new Error('Nao foi possivel obter as negociacoes da semana retrasada');\r\n\t\t});\r\n\t}\r\n\r\n\tobterNegociacoes(){\r\n\t\treturn Promise.all([\r\n\t\t\tthis.obterNegociacoesDaSemana(),\r\n\t\t\tthis.obterNegociacoesDaSemanaAnterior(),\r\n\t\t\tthis.obterNegociacoesDaSemanaRetrasada()]\r\n\t\t).then(periodos => {\r\n\t\t\tlet negociacoes = periodos\r\n\t\t\t\t.reduce((dados, periodo) => dados.concat(periodo), [])\r\n\t\t\treturn negociacoes;\r\n\t\t}).catch(erro => {\r\n\t\t\tthrow new Error(erro)\r\n\t\t});\r\n\t}\r\n\tcadastra(negociacao){\r\n\t\treturn ConnectionFactory\r\n\t\t\t.getConnection()\r\n\t\t\t.then(connection => new NegociacaoDao(connection))\r\n\t\t\t.then(dao => dao.adiciona(negociacao))\r\n\t\t\t.then(() => 'Negociacao adicionada com sucesso')\r\n\t\t\t.catch(erro => {\r\n\t\t\t\tconsole.log(erro);\r\n\t\t\t\tthrow new Error('nao foi possivel adicionar a negociacao')\r\n\t\t\t});\r\n\t}\r\n\tlista(){\r\n\t\treturn ConnectionFactory\r\n\t\t\t.getConnection()\r\n\t\t\t.then(connection => new NegociacaoDao(connection))\r\n\t\t\t.then(dao => dao.listaTodos())\r\n\t\t\t.catch(erro => {\r\n\t\t\t\tconsole.log(erro);\r\n\t\t\t\tthrow new Error('Nao foi possivel listar as negociacoes');\r\n\t\t\t});\r\n\t}\r\n\r\n\tapaga(){\r\n\t\treturn ConnectionFactory\r\n\t\t\t.getConnection()\r\n\t\t\t.then(connection => new NegociacaoDao(connection))\r\n\t\t\t.then(dao => dao.apagaTodos())\r\n\t\t\t.then(() => 'Negociacoes apagadas com sucesso')\r\n\t\t\t.catch(erro => {\r\n\t\t\t\tconsole.log(erro);\r\n\t\t\t\tthrow new Error('nao foi possivel apagar as negociacoes')\r\n\t\t\t});\r\n\t}\r\n\r\n\timporta(listaAtual){\r\n\t\treturn this.obterNegociacoes()\r\n\t\t\t.then(negociacoes =>\r\n\t\t\t\tnegociacoes.filter(negociacao =>\r\n\t\t\t\t\t!listaAtual.some(negociacaoExistente =>\r\n\t\t\t\t\t\tnegociacao.isEquals(negociacaoExistente)))\r\n\t\t\t).catch(erro => {\r\n\t\t\t\tconsole.log(erro);\r\n\t\t\t\tthrow new Error('nao foi possivel buscar negociacoes para importar')\r\n\t\t\t});\r\n\t}\r\n\r\n}"]}