{"version":3,"sources":["../../app-es6/services/NegociacaoService.js"],"names":["NegociacaoService","_http","HttpService","get","then","negociacoes","map","Negociacao","Date","objeto","data","quantidade","valor","catch","console","log","erro","Error","Promise","all","obterNegociacoesDaSemana","obterNegociacoesDaSemanaAnterior","obterNegociacoesDaSemanaRetrasada","periodos","reduce","dados","periodo","concat","negociacao","ConnectionFactory","getConnection","NegociacaoDao","connection","dao","adiciona","listaTodos","apagaTodos","listaAtual","obterNegociacoes","filter","some","isEquals","negociacaoExistente"],"mappings":"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","file":"NegociacaoService.js","sourcesContent":["class NegociacaoService{\r\n\tconstructor(){\r\n\t\tthis._http = new HttpService();\r\n\t}\r\n\r\n\tobterNegociacoesDaSemana(){\r\n\r\n\t\treturn this._http.get('negociacoes/semana')\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\treturn negociacoes.map(objeto => new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor));\r\n\t\t\t}).catch(erro => {\r\n\t\t\t\tconsole.log(erro);\r\n\t\t\t\tthrow new Error('Nao foi possivel obter as negociacoes da semana');\r\n\t\t\t});\r\n\t}\r\n\r\n\tobterNegociacoesDaSemanaAnterior(){\r\n\t\treturn this._http.get('negociacoes/anterior')\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\treturn negociacoes.map(objeto => new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor));\r\n\t\t\t}).catch(erro => {\r\n\t\t\t\tconsole.log(erro);\r\n\t\t\t\tthrow new Error('Nao foi possivel obter as negociacoes da semana Anterior');\r\n\t\t});\r\n\t}\r\n\r\n\tobterNegociacoesDaSemanaRetrasada(){\r\n\t\treturn this._http.get('negociacoes/retrasada')\r\n\t\t\t.then(negociacoes => {\r\n\t\t\t\treturn negociacoes.map(objeto => new Negociacao(new Date(objeto.data), objeto.quantidade, objeto.valor));\r\n\t\t\t}).catch(erro => {\r\n\t\t\t\tconsole.log(erro);\r\n\t\t\t\tthrow new Error('Nao foi possivel obter as negociacoes da semana retrasada');\r\n\t\t});\r\n\t}\r\n\r\n\tobterNegociacoes(){\r\n\t\treturn Promise.all([\r\n\t\t\tthis.obterNegociacoesDaSemana(),\r\n\t\t\tthis.obterNegociacoesDaSemanaAnterior(),\r\n\t\t\tthis.obterNegociacoesDaSemanaRetrasada()]\r\n\t\t).then(periodos => {\r\n\t\t\tlet negociacoes = periodos\r\n\t\t\t\t.reduce((dados, periodo) => dados.concat(periodo), [])\r\n\t\t\treturn negociacoes;\r\n\t\t}).catch(erro => {\r\n\t\t\tthrow new Error(erro)\r\n\t\t});\r\n\t}\r\n\tcadastra(negociacao){\r\n\t\treturn ConnectionFactory\r\n\t\t\t.getConnection()\r\n\t\t\t.then(connection => new NegociacaoDao(connection))\r\n\t\t\t.then(dao => dao.adiciona(negociacao))\r\n\t\t\t.then(() => 'Negociacao adicionada com sucesso')\r\n\t\t\t.catch(erro => {\r\n\t\t\t\tconsole.log(erro);\r\n\t\t\t\tthrow new Error('nao foi possivel adicionar a negociacao')\r\n\t\t\t});\r\n\t}\r\n\tlista(){\r\n\t\treturn ConnectionFactory\r\n\t\t\t.getConnection()\r\n\t\t\t.then(connection => new NegociacaoDao(connection))\r\n\t\t\t.then(dao => dao.listaTodos())\r\n\t\t\t.catch(erro => {\r\n\t\t\t\tconsole.log(erro);\r\n\t\t\t\tthrow new Error('Nao foi possivel listar as negociacoes');\r\n\t\t\t});\r\n\t}\r\n\r\n\tapaga(){\r\n\t\treturn ConnectionFactory\r\n\t\t\t.getConnection()\r\n\t\t\t.then(connection => new NegociacaoDao(connection))\r\n\t\t\t.then(dao => dao.apagaTodos())\r\n\t\t\t.then(() => 'Negociacoes apagadas com sucesso')\r\n\t\t\t.catch(erro => {\r\n\t\t\t\tconsole.log(erro);\r\n\t\t\t\tthrow new Error('nao foi possivel apagar as negociacoes')\r\n\t\t\t});\r\n\t}\r\n\r\n\timporta(listaAtual){\r\n\t\treturn this.obterNegociacoes()\r\n\t\t\t.then(negociacoes =>\r\n\t\t\t\tnegociacoes.filter(negociacao =>\r\n\t\t\t\t\t!listaAtual.some(negociacaoExistente =>\r\n\t\t\t\t\t\tnegociacao.isEquals(negociacaoExistente)))\r\n\t\t\t).catch(erro => {\r\n\t\t\t\tconsole.log(erro);\r\n\t\t\t\tthrow new Error('nao foi possivel buscar negociacoes para importar')\r\n\t\t\t});\r\n\t}\r\n\r\n}"]}